var engine=function(e){"use strict";const n=navigator.userAgent,t=navigator.serviceWorker,o=n.match(/webOS/i),r=n.match(/Android/i)||n.match(/iPhone/i)||n.match(/iPad/i)||n.match(/iPod/i)||n.match(/BlackBerry/i)||n.match(/Windows Phone/i),i=new Map;function a(e,n){for(const t of i.get(e))t(n)}let c=performance.now(),u=0;const s=[];function f(e){let n=e-c;for(const e of s)e(n);c=e,u=requestAnimationFrame(f)}const d=new Set(navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads());function l(){addEventListener("ongamepadconnected",m),addEventListener("ongamepaddisconnected",p),s.push(A)}function A(e){for(const e of d);}function m(e){d.add(e.gamepad)}function p(e){d.delete(e.gamepad)}function P(){addEventListener("keydown",E),addEventListener("keyup",L)}function E(e){a(e.code,e)}function L(e){a(e.code,e)}function _(){addEventListener("mousedown",g),addEventListener("mousemove",h),addEventListener("mouseup",D),addEventListener("mousewheel",T),addEventListener("contextmenu",v)}function g(e){}function h(e){}function D(e){}function T(e){}function v(e){e.preventDefault()}function S(){addEventListener("touchstart",b),addEventListener("touchmove",C),addEventListener("touchend",y),addEventListener("touchcancel",O)}function b(e){}function C(e){}function y(e){}function O(e){}function w(){s.push(I)}function I(e){}function R(){addEventListener("online",N),addEventListener("offline",G)}function N(){}function G(){}function F(e){return{set:(n,t,o)=>(n[t]=o,e(n,t,o),!0)}}function K(e){return{defineProperty:(n,t,o)=>(Object.defineProperty(n,t,o),e(n,t),!0)}}function U(e){return{deleteProperty(n,t){e(n,t),delete n[t]}}}function x(e,n,t){if(e.has(n))return e.get(n);{let o=t();return e.set(n,o),o}}const k=new Map,j={...F(B),...K(B),...U((function(e,n){for(const t of k.get(n))t.delete(e)}))};function B(e,n){for(const t of k.get(n))t.add(e)}function H(e){return fetch(e).then(e=>e.blob())}function M(e){return fetch(e).then(e=>e.json())}function W(e){return fetch(e).then(e=>e.text())}function z(e){return new Promise((function(n,t){let o=new Image;o.onload=function(){n(o)},o.src=e}))}const V={path:"/resources",extensions:{json:M,png:z,mtl:W,obj:W,glsl:W,bin:H}};return e.captureShallowObjectChanges=function(e){return new Proxy(e,{set:(e,n,t)=>(e.changed=!0,e[n]=t,!0)})},e.clamp=function(e,n,t){return e>=t?t:e<=n?n:e},e.createAssignPropertyTrap=F,e.createDefinePropertyTrap=K,e.createDeletePropertyTrap=U,e.createEntity=function(){return new Proxy({},j)},e.defaultGamepadControls={UP:"PAD_UP",DOWN:"PAD_DOWN",LEFT:"PAD_LEFT",RIGHT:"PAD_RIGHT",ACTION1:"PAD_FACE_1",ACTION2:"PAD_FACE_2",ACTION3:"PAD_FACE_3",ACTION4:"PAD_FACE_4",SPECIAL1:"PAD_L_SHOULDER_1",SPECIAL2:"PAD_R_SHOULDER_1",SPECIAL3:"PAD_L_SHOULDER_2",SPECIAL4:"PAD_R_SHOULDER_2",SPECIAL5:"PAD_L_STICK_BUTTON",SPECIAL6:"PAD_R_STICK_BUTTON",SPECIAL7:"PAD_VENDOR",ANALOG1:"PAD_L_STICK_X",ANALOG2:"PAD_L_STICK_Y",ANALOG3:"PAD_R_STICK_X",ANALOG4:"PAD_R_STICK_Y",SELECT:"PAD_SELECT",START:"PAD_START"},e.defaultKeyboardControls={UP:"ArrowUp",DOWN:"ArrowDown",LEFT:"ArrowLeft",RIGHT:"ArrowRight",ENTER:"Enter"},e.defaultMouseControls={},e.defaultTouchControls={},e.defineLinkedProperty=function(e,n,t){Object.defineProperty(e,n,{get:()=>t[n],set:e=>{t[n]=e}})},e.defineObservedProperty=function(e,n,t,o){Object.defineProperty(e,n,{get:()=>t[n],set:e=>{o(e,t[n]),t[n]=e}})},e.deleteEntity=function(e){for(const n in e)deleteComponent(e,n)},e.enableGamepads=l,e.enableKeyboard=P,e.enableMouse=_,e.enableNetwork=w,e.enableOfflineSupport=R,e.enableTouch=S,e.events=i,e.firstSubstring=function(e,n){return e.substring(0,n)},e.generateNormalizedRandomNumber=function(){return 2*Math.random()-1},e.getOrAddMapValue=x,e.initialize2dPreset=function(){l(),P(),_(),S(),w(),R()},e.insertArrayElement=function(e,n,t){e.splice(t,0,n)},e.isMobile=r,e.isTv=o,e.lastArrayElement=function(e){return e[e.length-1]},e.lerp=function(e,n,t){return e+(e-n)*t},e.loadArrayBuffer=function(e){return fetch(e).then(e=>e.arrayBuffer())},e.loadBlob=H,e.loadFormData=function(e){return fetch(e).then(e=>e.formData())},e.loadImage=z,e.loadJson=M,e.loadLocalState=function(e){for(const n in e)localStorage.setKey(n,e[n])},e.loadResource=function(e){let n=e.substring(e.lastIndexOf(".")+1);return V.extensions[n](`${V.path}/${e}`)},e.loadResources=async function(e,n){for(const t in e)e[t]=await n(e[t])},e.loadText=W,e.publish=a,e.registerComponentSystem=function(e,n){x(k,e,()=>new Set).add(n)},e.removeArrayElement=function(e,n){e.splice(e.indexOf(n),1)},e.removeNewLines=function(e){return e.replace(/\n/g,"")},e.resourceOptions=V,e.saveLocalState=function(e){for(const n in e)e[n]=localStorage.getKey(n)},e.serviceWorker=t,e.start=function(){f(performance.now())},e.stop=function(){cancelAnimationFrame(u)},e.subscribe=function(e,n){i.get(e).add(n)},e.systems=s,e.unsubscribe=function(e,n){i.get(e).delete(n)},e.userAgent=n,e}({});
